## 本書について {#sec:intro:about-this-book}

本書は二部構成となっている。

第1部では、**型クラスの自動導出** を紹介する。これは、わずかなジェネリックな規則のみから、任意の代数的データ型に対する型クラスを作り出すことを可能にするものだ。
第1部は4つの章からなる:

  - [@sec:representations]章では、**ジェネリック表現(generic representation)** を導入する。
    また、shapeless の `Generic` 型クラスもここで導入する。これは任意のケースクラスや sealed トレイトのジェネリックな表現の生成を可能にする。

  - [@sec:generic]章では、`Generic` を独自の型クラスのインスタンスを導出するのに利用する。
    例として、Scala のデータを CSV にエンコードする型クラスを作っていくが、ここで説明するテクニックは多くの状況で応用できる。
    また、shapeless の `Lazy` 型を導入する。これはリストや木のような再帰的なデータを扱えるようにするものである。

  - [@sec:type-level-programming]章では、ここまでの章で紹介したテクニックを一般化するために知っておく必要がある理論やプログラミングパターンを説明する。
    特に、依存型(dependent type)、依存型付け関数(dependently typed function)、そして型レベルプログラミング(type level programming)について詳しく見ていく。
    これにより、shapeless のより高度な応用に触れることができるようになる。

  - [@sec:labelled-generic]章では、`LabelledGeneric` という、ジェネリック表現の一部としてフィールドや型名を公開するような `Generic` の変種を導入する。
    加えて、リテラル型(literal type)、シングルトン型(singleton type)、幽霊型(phantom type)、そして型タグ付け(type tagging)についても説明する。
    フィールドや型の名前を出力に反映する JSON エンコーダ を作成することで、`LabelledGeneric` の利用法を実演する。

第2部では、`shapeless.ops` パッケージにある「演算型クラス(ops type class)」を紹介する。
演算型クラスは、ジェネリック表現に対する幅広い操作を可能にするツールのライブラリを成している。
本書では、すべての演算を詳しく見ていくことはせず、かわりに3章にわたって入門的な理論についての説明を行う:

  - [@sec:ops]章では、演算型クラスの基本的な配置について説明し、例として、いくつかのシンプルな演算を組み合わせて強力な「ケースクラスのマイグレーション」ツールを作成する。

  - [@sec:poly]章では、`Poly` としても知られる **多相的関数(polymorphic function)** を導入し、ジェネリック表現に対して map、flat map、fold のような操作を行うために多相的関数がどのように利用されているかを示す。

  - 最後に、[@sec:nat]章では、shapelessにおいて型レベルで自然数を表現するのに利用されている `Nat` 型を紹介する。
    関連するいくつかの演算型クラスについても説明し、また `Nat` を利用して Scalacheck の `Arbitrary` を自分の手で実装していく。
